{"version":3,"file":"vue.js","sources":["../src/observe/index.js","../src/initState.js","../src/init.js","../src/index.js"],"sourcesContent":["export function observer(data) {\r\n  if (typeof data !== 'object' || data === null) {\r\n    // data不是对象或者data为空 不劫持\r\n    return data\r\n  }\r\n  console.log('劫持data:', data)\r\n  return new Observer(data)\r\n}\r\n\r\nclass Observer {\r\n  constructor(value) {\r\n    this.walk(value)\r\n  }\r\n  walk(data) {\r\n    let keys = Object.keys(data)\r\n    // console.log('keys', keys)\r\n    for (let i = 0; i < keys.length; i++) {\r\n      const key = keys[i]\r\n      const value = data[key]\r\n      // 对每一个属性进行劫持\r\n      defineReactive(data, key, value)\r\n    }\r\n  }\r\n}\r\n// 对对象中的属性进行劫持\r\nfunction defineReactive(data, key, value) {\r\n  observer(value) //深度递归劫持\r\n  Object.defineProperty(data, key, {\r\n    get() {\r\n      console.log('获取')\r\n      return value\r\n    },\r\n    set(newVal) {\r\n      console.log('设置')\r\n      if (newVal === value) return\r\n      observer(newVal) //对设置的值 进行劫持\r\n      value = newVal\r\n    }\r\n  })\r\n}\r\n","import { observer } from './observe/index'\r\nexport function initState(vm) {\r\n  let ops = vm.$options\r\n  // console.log('ops', ops)\r\n  if (ops.data) {\r\n    initData(vm)\r\n  }\r\n  if (ops.props) {\r\n    initProps()\r\n  }\r\n  if (ops.watch) {\r\n    initWatch()\r\n  }\r\n  if (ops.computed) {\r\n    initComputed()\r\n  }\r\n  if (ops.methods) {\r\n    initMethods()\r\n  }\r\n}\r\n\r\nfunction initData(vm) {\r\n  // console.log('vm:data初始化', vm)\r\n  let data = vm.$options.data\r\n  // 对象或者函数\r\n  if (typeof data === 'object' && data !== null) {\r\n    data = data\r\n  } else if (typeof data === 'function') {\r\n    data = data.call(vm)\r\n  } else {\r\n    console.error('data type error')\r\n    return false\r\n  }\r\n  vm._data = data\r\n  // 对data数据进行劫持\r\n  observer(data)\r\n}\r\n\r\nfunction initProps() {}\r\nfunction initWatch() {}\r\nfunction initComputed() {}\r\nfunction initMethods() {}\r\n","import { initState } from './initState'\r\n\r\nexport function initMixin(Vue) {\r\n  Vue.prototype._init = function (options) {\r\n    // console.log('options', options)\r\n    let vm = this\r\n    vm.$options = options\r\n    // 初始化状态\r\n    initState(vm)\r\n  }\r\n}\r\n","import { initMixin } from './init'\r\n\r\nfunction Vue(options) {\r\n  // 初始化\r\n  this._init(options)\r\n}\r\n\r\ninitMixin(Vue)\r\n\r\nexport default Vue\r\n"],"names":["observer","data","console","log","Observer","value","walk","keys","Object","i","length","key","defineReactive","defineProperty","get","set","newVal","initState","vm","ops","$options","initData","props","watch","computed","methods","call","error","_data","initMixin","Vue","prototype","_init","options"],"mappings":"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"}